# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å Supabase Storage

## –ü—Ä–æ–±–ª–µ–º–∞
```
ERROR [MediaService] Bucket 'order-media' –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ Supabase.
```

## –®–∞–≥–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∏—Ç–µ –º–µ–¥–∏–∞ —Ñ–∞–π–ª –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏:

```
[MediaService] üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º bucket 'order-media'...
[MediaService] üìã –ù–∞–π–¥–µ–Ω–æ buckets: X
[MediaService] –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö buckets:
  1. "bucket-name-1" (id: xxx, public: true)
  2. "bucket-name-2" (id: xxx, public: false)
```

### 2. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### –ü—Ä–∏—á–∏–Ω–∞ 1: Bucket —Å–æ–∑–¥–∞–Ω —Å –¥—Ä—É–≥–∏–º –∏–º–µ–Ω–µ–º
**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö buckets
- –ï—Å–ª–∏ –≤–∞—à bucket –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É, –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –µ–≥–æ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ `BUCKET_NAME` –≤ –∫–æ–¥–µ

#### –ü—Ä–∏—á–∏–Ω–∞ 2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç Supabase
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –û—Ç–∫—Ä–æ–π—Ç–µ `src/services/supabaseClient.ts`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `SUPABASE_URL` –∏ `SUPABASE_ANON_KEY` —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã —Å–æ–∑–¥–∞–ª–∏ bucket –≤ —Ç–æ–º –∂–µ –ø—Ä–æ–µ–∫—Ç–µ

#### –ü—Ä–∏—á–∏–Ω–∞ 3: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
**–†–µ—à–µ–Ω–∏–µ:**
- –í Supabase –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage** ‚Üí **Policies**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è buckets:
```sql
CREATE POLICY "–õ—é–±–æ–π –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å buckets" ON storage.buckets 
FOR SELECT 
USING (true);
```

#### –ü—Ä–∏—á–∏–Ω–∞ 4: –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
```
[MediaService] ‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Storage: [–¥–µ—Ç–∞–ª–∏]
```

### 3. –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ SQL Editor

–ó–∞–π–¥–∏—Ç–µ –≤ **SQL Editor** –≤ Supabase –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
-- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö buckets
SELECT * FROM storage.buckets;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–∏—Ç–∏–∫
SELECT * FROM pg_policies WHERE tablename = 'buckets';
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ bucket —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

1. **Storage** ‚Üí **Create a new bucket**
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
   ```
   Name: order-media
   Public bucket: ‚úÖ –î–ê
   File size limit: 50MB
   Allowed MIME types: image/*, video/*
   ```

3. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏:**
```sql
-- –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ buckets
CREATE POLICY "–õ—é–±–æ–π –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å buckets" ON storage.buckets 
FOR SELECT 
USING (true);

-- –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
CREATE POLICY "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å" ON storage.objects 
FOR INSERT 
WITH CHECK (bucket_id = 'order-media' AND auth.role() = 'authenticated');

-- –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
CREATE POLICY "–ü—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤" ON storage.objects 
FOR SELECT 
USING (bucket_id = 'order-media');
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–¥–∏–∞ —Ñ–∞–π–ª. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
[MediaService] ‚úÖ Bucket 'order-media' –Ω–∞–π–¥–µ–Ω!
[MediaService] ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ X —Ñ–∞–π–ª–æ–≤
```

### 6. –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º. 