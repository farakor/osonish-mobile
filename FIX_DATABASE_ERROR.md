# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
```
ERROR [OrderService] ‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏: 
{"code": "PGRST202", "details": "Searched for the function public.get_pending_ratings_for_customer with parameter p_customer_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.", "hint": null, "message": "Could not find the function public.get_pending_ratings_for_customer(p_customer_id) in the schema cache"}
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [supabase.com](https://supabase.com)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç
3. –û—Ç–∫—Ä–æ–π—Ç–µ **SQL Editor** (–ª–µ–≤–æ–µ –º–µ–Ω—é)

### –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `SQL/fix_auto_order_update_dependencies.sql`
2. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
3. –ù–∞–∂–º–∏—Ç–µ **Run** (–∏–ª–∏ Ctrl/Cmd + Enter)

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏:

```
object_type                              | status
----------------------------------------|----------
pending_ratings table                   | ‚úÖ EXISTS
auto_completed column                   | ‚úÖ EXISTS  
auto_cancelled column                   | ‚úÖ EXISTS
get_pending_ratings_for_customer function| ‚úÖ EXISTS
add_pending_rating function             | ‚úÖ EXISTS
remove_pending_rating function          | ‚úÖ EXISTS
```

–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **‚úÖ EXISTS**.

## üß™ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL —Å–∫—Ä–∏–ø—Ç–∞:

1. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** Expo Go
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω** –∑–∞–∫–∞–∑—á–∏–∫–∞
3. **–ù–∞–π–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –ø–∞–Ω–µ–ª—å** –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞
4. **–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"** ‚Üí –¥–æ–ª–∂–Ω—ã —Å–æ–∑–¥–∞—Ç—å—Å—è 3 –∑–∞–∫–∞–∑–∞
   - –ù–∞–∂–º–∏—Ç–µ **"–ó–∞–ø—É—Å—Ç–∏—Ç—å"** ‚Üí –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –±–µ–∑ –æ—à–∏–±–æ–∫
   - –ù–∞–∂–º–∏—Ç–µ **"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"** ‚Üí –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üîç –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç

### 1. –°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É `pending_ratings`
- –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –æ—Ü–µ–Ω–∫–∏
- –° –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏ –∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏

### 2. –î–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É `orders`
- `auto_completed` - —Ñ–ª–∞–≥ –∞–≤—Ç–æ–∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- `auto_cancelled` - —Ñ–ª–∞–≥ –∞–≤—Ç–æ–æ—Ç–º–µ–Ω—ã

### 3. –°–æ–∑–¥–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `get_pending_ratings_for_customer()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏
- `add_pending_rating()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ–± –æ—Ü–µ–Ω–∫–µ
- `remove_pending_rating()` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ–± –æ—Ü–µ–Ω–∫–µ

### 4. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ü–æ–ª–∏—Ç–∏–∫–∏ Row Level Security (RLS)

## ‚ö†Ô∏è –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
SELECT current_database(), current_user, now();
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
SELECT routine_name, routine_type 
FROM information_schema.routines 
WHERE routine_schema = 'public' 
AND routine_name LIKE '%pending_rating%';
```

### –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à Supabase:
1. –í Supabase Dashboard –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings**
2. –ù–∞–π–¥–∏—Ç–µ **API** —Ä–∞–∑–¥–µ–ª  
3. –ù–∞–∂–º–∏—Ç–µ **Restart API** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
- ‚úÖ **–°–æ–∑–¥–∞—Ç—å**: 3 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞
- ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç—å**: –±–µ–∑ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: "–ê–≤—Ç–æ–∑–∞–≤–µ—Ä—à–µ–Ω–æ: 1, –ê–≤—Ç–æ–æ—Ç–º–µ–Ω–µ–Ω–æ: 2"
- ‚úÖ **–û—á–∏—Å—Ç–∏—Ç—å**: —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã —É–¥–∞–ª–µ–Ω—ã

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ: 30 —Å–µ–Ω—Ç—è–±—Ä—è 2025*
