# üîî –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—Ç–ª–∞–¥–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö

## üöÄ –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ —ç—Ç–∞–ø—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö:

### üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **OrderService.sendNewOrderNotifications()** - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. **NotificationService.sendNotificationToUser()** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é  
3. **ProductionNotificationService.sendViaExpoAPI()** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Expo Push Service

### üîç –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –∏–∑ –ë–î
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ push —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ Expo API
- ‚úÖ –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å stack trace

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –í –∫–æ–Ω—Å–æ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (Expo Go/Development):
```javascript
// –¢–µ—Å—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∑–∞–∫–∞–∑–æ–º
global.debugNotifications.testNewOrderNotifications('order-id-here');

// –¢–µ—Å—Ç —Å —Ç–µ—Å—Ç–æ–≤—ã–º –∑–∞–∫–∞–∑–æ–º
global.debugNotifications.testNewOrderNotifications();

// –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
global.debugNotifications.clearNotificationCache();

// –ü—Ä–æ—Å–º–æ—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
global.debugNotifications.getNotifiedOrders();
```

### 2. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞:
–ü—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ - –≤—Å–µ –ª–æ–≥–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª.

## üîç –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
```
üî•üî•üî• [OrderService] –ù–ê–ß–ê–õ–û –û–¢–ü–†–ê–í–ö–ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ô –û –ù–û–í–û–ú –ó–ê–ö–ê–ó–ï üî•üî•üî•
[OrderService] üì§ –ó–∞–∫–∞–∑ ID: some-order-id
[OrderService] üë• –ù–∞–π–¥–µ–Ω–æ X –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
[OrderService] üìù –ü–æ–ª—É—á–µ–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–æ–≤: X –∏–∑ X –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö
[OrderService] ‚úÖ –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: X
[OrderService] üìä –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: 100%
```

### ‚ùå –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

#### 1. –ù–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π:
```
[OrderService] ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ù–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
[OrderService] üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å role="worker" –≤ —Ç–∞–±–ª–∏—Ü–µ users
```

#### 2. –ù–µ—Ç push —Ç–æ–∫–µ–Ω–æ–≤:
```
[NotificationService] ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö push —Ç–æ–∫–µ–Ω–æ–≤
[NotificationService] üí° - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–∞–ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
[NotificationService] üí° - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–æ —Ç–æ–∫–µ–Ω
```

#### 3. –û—à–∏–±–∫–∞ Expo API:
```
[ProductionNotificationService] ‚ùå HTTP –æ—à–∏–±–∫–∞: 400 Bad Request
[ProductionNotificationService] üìä –°—Ç–∞—Ç—É—Å –æ—Ç Expo: error
[ProductionNotificationService] üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç Expo: Invalid push token
```

#### 4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã:
```
[NotificationService] üîá –ë–õ–û–ö–ò–†–û–í–ö–ê: –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

## üõ†Ô∏è –ß–∞—Å—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

### 1. –ù–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –≤ –ë–î:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `users` –≤ Supabase
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `role = 'worker'`

### 2. –ù–µ—Ç push —Ç–æ–∫–µ–Ω–æ–≤:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `push_tokens` –≤ Supabase
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–∞–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤

### 3. –ü—Ä–æ–±–ª–µ–º—ã —Å Expo API:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –≤–∞–ª–∏–¥–Ω—ã–µ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `ExponentPushToken[`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å Expo Push Service

### 4. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É:
```javascript
// –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
global.debugNotifications.clearNotificationCache();
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–õ–æ–≥–∏ –≤–∫–ª—é—á–∞—é—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î: `‚è±Ô∏è –ó–∞–ø—Ä–æ—Å –∫ –ë–î –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞ X–º—Å`
- –ü–µ—Ä–µ–≤–æ–¥—ã: `‚è±Ô∏è –ü–µ—Ä–µ–≤–æ–¥—ã –ø–æ–ª—É—á–µ–Ω—ã –∑–∞ X–º—Å`
- HTTP –∑–∞–ø—Ä–æ—Å—ã: `‚è±Ô∏è HTTP –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞ X–º—Å`

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç**: `global.debugNotifications.testNewOrderNotifications()`
2. **–ò–∑—É—á–∏—Ç–µ –ª–æ–≥–∏** –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
3. **–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É** –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –≤—ã—à–µ
4. **–ò—Å–ø—Ä–∞–≤—å—Ç–µ** –Ω–∞–π–¥–µ–Ω–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É
5. **–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ—Å—Ç**

## üìû –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω—ã:
- –õ–æ–≥–∏ —Å üî•üî•üî• (–Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü –ø—Ä–æ—Ü–µ—Å—Å–∞)
- –õ–æ–≥–∏ —Å ‚ùå (–æ—à–∏–±–∫–∏)
- –õ–æ–≥–∏ —Å ‚ö†Ô∏è (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è)
